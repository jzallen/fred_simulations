template:
  path: secretsmanager/database-secrets.json

# Layer 1: No dependencies - Secrets Manager creates password first
# RDS and other stacks will read password from here using resolvers
dependencies: []

# Stack parameters for staging environment
parameters:
  Environment: staging
  # Password provided via environment variable for security
  DBPassword: !environment_variable EPISTEMIX_DB_PASSWORD

stack_tags:
  Project: epistemix-platform
  Environment: staging
  ManagedBy: sceptre
  Purpose: SecretsManager

# Sceptre hooks for template validation
validation_hooks: &validation_hooks
  - !cmd |
    echo '▶ (database-secrets) Running cfn-lint...' && \
    cfn-lint templates/secretsmanager/database-secrets.json && \
    echo '✓ (database-secrets) cfn-lint passed'

hooks:
  before_validate: *validation_hooks
  before_create: *validation_hooks
  before_update: *validation_hooks
