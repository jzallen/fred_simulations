poetry_requirements(
    name="epistemix-reqs",
)

pex_binary(
    name="epistemix-cli",
    entry_point="epistemix_platform.cli:cli",
    dependencies=[
        "./src/epistemix_platform:lib",
        ":epistemix-reqs#click",
        ":epistemix-reqs#requests",
        ":epistemix-reqs#returns",
        ":epistemix-reqs#pydantic",
        ":epistemix-reqs#boto3",
        ":epistemix-reqs#botocore",
        ":epistemix-reqs#python-dotenv",
        ":epistemix-reqs#sqlalchemy",
    ],
)

python_tests(
    name="src-tests",
    sources=[
        "tests/**/test_*.py",
        "tests/test_*.py",
    ],
    dependencies=[
        "./src/epistemix_platform:lib",
        "./tests:test-utils",
        "//:root#freezegun",
        "//:root#pytest"
    ],
)

python_tests(
    name="infrastructure-tests",
    sources=[
        "infrastructure/tests/**/test_*.py",
    ],
    dependencies=[
        "./infrastructure/tests:test-utils",
        "./infrastructure:lib",
        "./infrastructure:infrastructure-reqs#sceptre",
        "./infrastructure:infrastructure-reqs#jsonschema",
        "//:root#pytest",
    ],
)
