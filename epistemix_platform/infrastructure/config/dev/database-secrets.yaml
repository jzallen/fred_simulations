template:
  path: secretsmanager/database-secrets.json

# Dependencies - RDS stack must exist first
dependencies:
  - dev/rds-postgres.yaml

# Stack parameters for development environment
parameters:
  Environment: dev
  # Password provided via environment variable for security
  DBPassword: !environment_variable EPISTEMIX_DB_PASSWORD

stack_tags:
  Project: epistemix-platform
  Environment: dev
  ManagedBy: sceptre
  Purpose: SecretsManager

# Sceptre hooks for template validation
validation_hooks: &validation_hooks
  - !cmd |
    echo '▶ (database-secrets) Running cfn-lint...' && \
    cfn-lint templates/secretsmanager/database-secrets.json && \
    echo '✓ (database-secrets) cfn-lint passed'

hooks:
  before_validate: *validation_hooks
  before_create: *validation_hooks
  before_update: *validation_hooks
